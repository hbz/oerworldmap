<div
    role="complementary"
    data-view="map"
    data-focus="{{#scope}}{{@id}}{{/scope}} {{#scope.provider}}{{@id}} {{/scope.provider}}"
    class="color-scheme-map column-medium"
>
    <div class="hidden">
        <a href="/aggregation/" class="hijax transclude map-view-hidden" target="_self">Aggregations</a>
    </div>
</div>

<div role="main" class="column column-medium color-scheme-text bg-blue-palest">
    <div class="column-container">

        {{#scope}}

            <article class="resource" data-behaviour="populateMap">

                <script type="application/ld+json">
                    {{{.}}}
                </script>

                <div class="resource-header">

                    {{#if user.email}}
                        <button class="btn btn-inverted resource-edit-btn" data-toggle="modal" data-target="#resource-edit">
                            <i class="fa fa-pencil"></i>
                        </button>
                        <a target="_blank" href="/log/{{[@id]}}" class="btn btn-inverted resource-edit-btn">
                            <i class="fa fa-history"></i>
                        </a>
                    {{/if}}

                    <h1 class="resource-title">
                        {{getIcon @type}}
                        {{#localized name}}
                            {{[@value]}}
                        {{else}}
                            {{[@id]}}
                        {{/localized}}
                    </h1>

                    {{#serviceType}}
                        <div class="resource-subline">
                            <div class="resource-subline-label">Service Type</div>
                            {{.}}
                        </div>
                    {{/serviceType}}

                </div>

                {{#image}}
                    <div class="paragraph-image">
                        <a href="{{.}}" target="_blank">
                            <img src="{{.}}" width="250" />
                        </a>
                    </div>
                {{/image}}

                {{#localized description}}
                    <p>{{{[@value]}}}</p>
                {{/localized}}

                {{#availableChannel}}{{#serviceUrl}}
                    <p>
                        <a href="{{.}}" target="_blank" class="btn btn-default">
                            <i class="fa fa-external-link"></i>
                            {{stripProtocol .}}
                        </a>
                    </p>
                {{/serviceUrl}}{{/availableChannel}}

                {{#license}}
                    <img src="{{image}}" width="75" alt="{{name.0.[@value]}}" title="{{name.0.[@value]}}" />
                {{/license}}

                <table class="table resource-details-table">

                    <tr>
                        <td>{{i18n "Service.availableChannel.availableLanguage"}}</td>
                        <td>
                            <ul class="comma-seperated-list">
                                {{#availableChannel}}
                                    {{#availableLanguage}}
                                        <li>{{i18n . bundle = "languages"}}</li>
                                    {{/availableLanguage}}
                                {{/availableChannel}}
                            </ul>
                        </td>
                    </tr>

                    <tr>
                        <td>{{i18n "Service.audience"}}</td>
                        <td>
                            <ul class="resource-list truncated">
                                {{#audience}}
                                    <li>{{>ResourceIndex/link.mustache}}</li>
                                {{/audience}}
                            </ul>
                        </td>
                    </tr>

                    {{#if provider}}
                        <tr>
                            <td>{{i18n "Service.provider"}}</td>
                            <td>
                                <ul class="resource-list truncated">
                                    {{#provider}}
                                        <li>{{>ResourceIndex/link.mustache}}</li>
                                    {{/provider}}
                                </ul>
                            </td>
                        </tr>
                    {{/if}}

                    {{#if about}}
                        <tr>
                            <td>{{i18n "Service.about"}}</td>
                            <td>
                                <ul class="resource-list truncated">
                                    {{#about}}
                                        <li>{{>ResourceIndex/link.mustache}}</li>
                                    {{/about}}
                                </ul>
                            </td>
                        </tr>
                    {{/if}}

                    {{#if sameAs}}
                        <tr>
                            <td>{{i18n "Service.sameAs"}}</td>
                            <td>
                                <ul class="resource-list truncated">
                                    {{#sameAs}}
                                        <li>{{externalLink .}}</li>
                                    {{/sameAs}}
                                </ul>
                            </td>
                        </tr>
                    {{/if}}

                    {{#if memberOf}}
                        <tr>
                            <td>{{i18n "Service.memberOf"}}</td>
                            <td>
                                <ul class="resource-list truncated">
                                    {{#memberOf}}
                                        <li>{{>ResourceIndex/link.mustache}}</li>
                                    {{/memberOf}}
                                </ul>
                            </td>
                        </tr>
                    {{/if}}

                    {{#if keywords}}
                        <tr>
                            <td>{{i18n "Service.keywords"}}</td>
                            <td>
                                <ul class="comma-seperated-list">
                                    {{#keywords}}
                                        <li><a href="/resource/?filter.about.keywords={{.}}">{{.}}</a></li>
                                    {{/keywords}}
                                </ul>
                            </td>
                        </tr>
                    {{/if}}

                </table>

            </article>

        {{/scope}}

    </div>
</div>


<div class="modal fade resource-form-modal" id="resource-edit">
    <div class="modal-dialog">
        <div class="modal-content bg-blue-palest color-scheme-text">
            <div class="modal-body clearfix">

                <h1>Edit Service</h1>
                <form method="post" class="edit hijax" target="edit-service-feedback">

                    <div id="edit-service-feedback"></div>

                    {{> ResourceIndex/Service/edit.mustache scope}}

                    <div class="pull-right resource-form-top-padding">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Quit</button>
                        <button type="submit" class="btn btn-inverted">Save Changes</button>
                    </div>
                </form>

            </div>
        </div>
    </div>
</div>
